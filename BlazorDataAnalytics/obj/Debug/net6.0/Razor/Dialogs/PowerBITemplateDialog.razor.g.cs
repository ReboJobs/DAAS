#pragma checksum "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "11640450d20563596aa79a0d3d78f0ac8a9445b9"
// <auto-generated/>
#pragma warning disable 1591
namespace BlazorDataAnalytics.Dialogs
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using BlazorDataAnalytics;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using BlazorDataAnalytics.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using Blazored.Modal;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using Blazored.Modal.Services;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using Syncfusion.Blazor.DropDowns;

#line default
#line hidden
#nullable disable
#nullable restore
#line 14 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using Syncfusion.Blazor.Buttons;

#line default
#line hidden
#nullable disable
#nullable restore
#line 15 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using Syncfusion.Blazor.Inputs;

#line default
#line hidden
#nullable disable
#nullable restore
#line 16 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using Syncfusion.Blazor.Calendars;

#line default
#line hidden
#nullable disable
#nullable restore
#line 17 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using Syncfusion.Blazor.Spinner;

#line default
#line hidden
#nullable disable
#nullable restore
#line 18 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using Syncfusion.Blazor.Grids;

#line default
#line hidden
#nullable disable
#nullable restore
#line 19 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using Syncfusion.Blazor.SplitButtons;

#line default
#line hidden
#nullable disable
#nullable restore
#line 20 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using Syncfusion.Blazor.Popups;

#line default
#line hidden
#nullable disable
#nullable restore
#line 21 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using System.Security.Claims;

#line default
#line hidden
#nullable disable
#nullable restore
#line 22 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using Syncfusion.Blazor.RichTextEditor;

#line default
#line hidden
#nullable disable
#nullable restore
#line 23 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using Syncfusion.Blazor;

#line default
#line hidden
#nullable disable
#nullable restore
#line 24 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\_Imports.razor"
using BlazorDataAnalytics.Dialogs;

#line default
#line hidden
#nullable disable
#nullable restore
#line 1 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using Azure.Security.KeyVault.Secrets;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using BlazorDataAnalytics.Data;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using BlazorDataAnalytics.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using BlazorDataAnalytics.Services;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using BlazorDataAnalytics.Enums;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using BlazorDataAnalytics.Services.ReportDashboardService;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using BlazorDataAnalytics.Services.UserVaultService;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using BlazorDataAnalytics.Services.KeyVaultManager;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using Blazorade.Msal.Services;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using Microsoft.AnalysisServices.Tabular;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using Microsoft.Data.SqlClient;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using Microsoft.Identity.Client;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using Microsoft.PowerBI.Api;

#line default
#line hidden
#nullable disable
#nullable restore
#line 14 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using Microsoft.PowerBI.Api.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 15 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using Microsoft.Rest;

#line default
#line hidden
#nullable disable
#nullable restore
#line 16 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using Persistence.Config.Entities;

#line default
#line hidden
#nullable disable
#nullable restore
#line 17 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using Syncfusion.Blazor.Data;

#line default
#line hidden
#nullable disable
#nullable restore
#line 18 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using Microsoft.Azure.KeyVault;

#line default
#line hidden
#nullable disable
#nullable restore
#line 19 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using Microsoft.Azure.KeyVault.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 20 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using SecretProperties = Azure.Security.KeyVault.Secrets.SecretProperties;

#line default
#line hidden
#nullable disable
#nullable restore
#line 21 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using BlazorDataAnalytics.Services.UserSecurityService;

#line default
#line hidden
#nullable disable
#nullable restore
#line 22 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using Syncfusion.Blazor.Diagram;

#line default
#line hidden
#nullable disable
#nullable restore
#line 23 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using Syncfusion.Blazor.Navigations;

#line default
#line hidden
#nullable disable
#nullable restore
#line 24 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using BlazorDataAnalytics.Services.ServicePrincipalService;

#line default
#line hidden
#nullable disable
#nullable restore
#line 37 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using Microsoft.AspNetCore.Html;

#line default
#line hidden
#nullable disable
#nullable restore
#line 38 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using System.ComponentModel.DataAnnotations;

#line default
#line hidden
#nullable disable
#nullable restore
#line 39 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
using System.Web;

#line default
#line hidden
#nullable disable
    public partial class PowerBITemplateDialog : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
            __builder.AddMarkupContent(0, "<style> \r\n    .text-multiline textarea{ \r\n        height: 300px !important; \r\n    } \r\n</style> \r\n");
            __builder.OpenComponent<BlazorDataAnalytics.Dialogs.MessageBoxDialog>(1);
            __builder.AddComponentReferenceCapture(2, (__value) => {
#nullable restore
#line 45 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                    MessageDialog = (BlazorDataAnalytics.Dialogs.MessageBoxDialog)__value;

#line default
#line hidden
#nullable disable
            }
            );
            __builder.CloseComponent();
            __builder.AddMarkupContent(3, "\r\n");
            __builder.OpenComponent<Syncfusion.Blazor.Popups.SfDialog>(4);
            __builder.AddAttribute(5, "ID", "OuterDialog");
            __builder.AddAttribute(6, "Width", "1000px");
            __builder.AddAttribute(7, "ShowCloseIcon", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 46 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                          true

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(8, "AllowPrerender", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 46 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                                          true

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(9, "IsModal", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 46 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                                                         true

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(10, "EnableResize", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 46 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                                                                             true

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(11, "AllowDragging", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 46 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                                                                                                  true

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(12, "Visible", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 46 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                               IsVisible

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(13, "VisibleChanged", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<System.Boolean>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<System.Boolean>(this, global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.CreateInferredEventCallback(this, __value => IsVisible = __value, IsVisible))));
            __builder.AddAttribute(14, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder2) => {
                __builder2.OpenComponent<Syncfusion.Blazor.Popups.DialogTemplates>(15);
                __builder2.AddAttribute(16, "Header", (Microsoft.AspNetCore.Components.RenderFragment)((__builder3) => {
                    __builder3.AddContent(17, "Power BI Template");
                }
                ));
                __builder2.AddAttribute(18, "Content", (Microsoft.AspNetCore.Components.RenderFragment)((__builder3) => {
                    __builder3.OpenElement(19, "div");
                    __builder3.AddAttribute(20, "class", "modal-body");
                    __builder3.OpenElement(21, "div");
                    __builder3.AddAttribute(22, "class", "control-container");
                    __builder3.OpenComponent<Syncfusion.Blazor.Spinner.SfSpinner>(23);
                    __builder3.AddAttribute(24, "Visible", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 53 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                             showSpinner

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(25, "VisibleChanged", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<System.Boolean>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<System.Boolean>(this, global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.CreateInferredEventCallback(this, __value => showSpinner = __value, showSpinner))));
                    __builder3.CloseComponent();
#nullable restore
#line 55 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                      if(_report !=null && _report.Value.Count() > 0 ){

#line default
#line hidden
#nullable disable
                    __builder3.OpenComponent<Syncfusion.Blazor.Navigations.SfCarousel>(26);
                    __builder3.AddAttribute(27, "AutoPlay", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 56 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                false

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(28, "SelectedIndexChanged", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<System.Int32>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<System.Int32>(this, 
#nullable restore
#line 56 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                               OnChangeCarrosel

#line default
#line hidden
#nullable disable
                    )));
                    __builder3.AddAttribute(29, "Id", "CarouselSlide");
                    __builder3.AddAttribute(30, "EnablePersistence", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 56 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                                                                        false

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(31, "EnableTouchSwipe", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 56 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                                                                                                 true

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(32, "NextButtonTemplate", (Microsoft.AspNetCore.Components.RenderFragment)(
#nullable restore
#line 56 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                                                                                                                            NextButtonTemplate

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(33, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder4) => {
#nullable restore
#line 59 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                             if (_report != null)
                            {
                             foreach(var item in _report.Value)
                                       {

#line default
#line hidden
#nullable disable
                        __builder4.OpenComponent<Syncfusion.Blazor.Navigations.CarouselItem>(34);
                        __builder4.AddAttribute(35, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder5) => {
                            __builder5.OpenElement(36, "div");
                            __builder5.AddAttribute(37, "class", "floating-container");
                            __builder5.OpenElement(38, "h3");
#nullable restore
#line (65,49)-(65,58) 26 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
__builder5.AddContent(39, item.Name);

#line default
#line hidden
#nullable disable
                            __builder5.CloseElement();
                            __builder5.CloseElement();
                            __builder5.AddMarkupContent(40, "\r\n                                        ");
                            __builder5.OpenElement(41, "div");
                            __builder5.AddAttribute(42, "style", "width:100%;max-width: 100%;height:500px");
                            __builder5.AddElementReferenceCapture(43, (__value) => {
#nullable restore
#line 67 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                    carouselComponents[item.Id.ToString()] = __value;

#line default
#line hidden
#nullable disable
                            }
                            );
                            __builder5.CloseElement();
                        }
                        ));
                        __builder4.CloseComponent();
#nullable restore
#line 69 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                       
                                    }
                            }

#line default
#line hidden
#nullable disable
                    }
                    ));
                    __builder3.CloseComponent();
#nullable restore
#line 75 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                        }else{                           


#line default
#line hidden
#nullable disable
                    __builder3.AddMarkupContent(44, "<div class=\"container\" style=\"  height: 100%; align-items: center;text-align:center;\"><div class=\"alert alert-success\"><h2> No Available Template.</h2></div></div>");
#nullable restore
#line 83 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                        }

#line default
#line hidden
#nullable disable
                    __builder3.CloseElement();
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(45, "\r\n\r\n                 ");
                    __builder3.OpenElement(46, "div");
                    __builder3.AddAttribute(47, "class", "row");
                    __builder3.OpenElement(48, "div");
                    __builder3.AddAttribute(49, "class", "col-sm");
                    __builder3.OpenComponent<Syncfusion.Blazor.DropDowns.SfDropDownList<string, Dataset>>(50);
                    __builder3.AddAttribute(51, "Placeholder", "Bind to a Dataset");
                    __builder3.AddAttribute(52, "DataSource", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Collections.Generic.IEnumerable<Dataset>>(
#nullable restore
#line 90 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                                                                                       datasetListCustomer

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(53, "Value", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<string>(
#nullable restore
#line 90 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                                                         selectedDataset

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(54, "ValueChanged", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<string>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<string>(this, global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.CreateInferredEventCallback(this, __value => selectedDataset = __value, selectedDataset))));
                    __builder3.AddAttribute(55, "ValueExpression", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Linq.Expressions.Expression<System.Func<string>>>(() => selectedDataset));
                    __builder3.AddAttribute(56, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder4) => {
                        __builder4.OpenComponent<Syncfusion.Blazor.DropDowns.DropDownListFieldSettings>(57);
                        __builder4.AddAttribute(58, "Text", "Name");
                        __builder4.AddAttribute(59, "Value", "Id");
                        __builder4.CloseComponent();
                        __builder4.AddMarkupContent(60, " \r\n                                 ");
                        __builder4.OpenComponent<Syncfusion.Blazor.DropDowns.DropDownListEvents<string, Dataset>>(61);
                        __builder4.AddAttribute(62, "ValueChange", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<Syncfusion.Blazor.DropDowns.ChangeEventArgs<string, Dataset>>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Syncfusion.Blazor.DropDowns.ChangeEventArgs<string, Dataset>>(this, 
#nullable restore
#line 92 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                                   ValueChangeHandler

#line default
#line hidden
#nullable disable
                        )));
                        __builder4.CloseComponent();
                    }
                    ));
                    __builder3.CloseComponent();
                    __builder3.CloseElement();
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(63, "\r\n                 ");
                    __builder3.OpenElement(64, "div");
                    __builder3.AddAttribute(65, "class", "row");
                    __builder3.OpenElement(66, "div");
                    __builder3.AddAttribute(67, "class", "col-sm");
                    __builder3.AddMarkupContent(68, "<br>\r\n                             ");
                    __builder3.OpenComponent<Syncfusion.Blazor.Buttons.SfButton>(69);
                    __builder3.AddAttribute(70, "CssClass", "e-info");
                    __builder3.AddAttribute(71, "Content", "Create Report");
                    __builder3.AddAttribute(72, "OnClick", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<Microsoft.AspNetCore.Components.Web.MouseEventArgs>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 100 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                           OnBtnClick

#line default
#line hidden
#nullable disable
                    )));
                    __builder3.AddAttribute(73, "Disabled", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 100 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                                                  !IsEnableReportButton

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.CloseComponent();
                    __builder3.CloseElement();
                    __builder3.CloseElement();
                }
                ));
                __builder2.CloseComponent();
            }
            ));
            __builder.CloseComponent();
            __builder.AddMarkupContent(74, "\r\n\r\n                 ");
            __builder.OpenElement(75, "div");
            __builder.AddAttribute(76, "id", "target");
            __builder.OpenComponent<Syncfusion.Blazor.Popups.SfDialog>(77);
            __builder.AddAttribute(78, "ID", "innerDialog");
            __builder.AddAttribute(79, "Target", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.String>(
#nullable restore
#line 108 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                            Target

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(80, "Width", "300px");
            __builder.AddAttribute(81, "ShowCloseIcon", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 108 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                                 true

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(82, "AllowPrerender", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 108 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                                                                                  true

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(83, "IsModal", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 108 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                                                                                                 true

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(84, "Visible", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 108 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                                                      Visibility

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(85, "VisibleChanged", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<System.Boolean>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<System.Boolean>(this, global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.CreateInferredEventCallback(this, __value => Visibility = __value, Visibility))));
            __builder.AddAttribute(86, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder2) => {
                __builder2.OpenComponent<Syncfusion.Blazor.Popups.DialogTemplates>(87);
                __builder2.AddAttribute(88, "Header", (Microsoft.AspNetCore.Components.RenderFragment)((__builder3) => {
                    __builder3.AddContent(89, " Entry ");
                }
                ));
                __builder2.AddAttribute(90, "Content", (Microsoft.AspNetCore.Components.RenderFragment)((__builder3) => {
                    __builder3.OpenElement(91, "div");
                    __builder3.AddAttribute(92, "class", "row");
                    __builder3.OpenComponent<Syncfusion.Blazor.Inputs.SfTextBox>(93);
                    __builder3.AddAttribute(94, "Placeholder", "Enter Report Name");
                    __builder3.AddAttribute(95, "CssClass", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.String>(
#nullable restore
#line 113 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                                                     CssClass

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(96, "Value", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.String>(
#nullable restore
#line 113 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                              reportName

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(97, "ValueChanged", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<System.String>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<System.String>(this, global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.CreateInferredEventCallback(this, __value => reportName = __value, reportName))));
                    __builder3.AddAttribute(98, "ValueExpression", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Linq.Expressions.Expression<System.Func<System.String>>>(() => reportName));
                    __builder3.CloseComponent();
                    __builder3.AddMarkupContent(99, "\r\n                                     <br><br>\r\n                                           ");
                    __builder3.OpenComponent<Syncfusion.Blazor.SplitButtons.SfProgressButton>(100);
                    __builder3.AddAttribute(101, "Content", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.String>(
#nullable restore
#line 115 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                       Content

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(102, "EnableProgress", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 115 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                                true

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(103, "CssClass", "e-success");
                    __builder3.AddAttribute(104, "Duration", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Double>(
#nullable restore
#line 115 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                                                                     1000

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(105, "IconCss", "e-icons e-save e-small camera");
                    __builder3.AddAttribute(106, "Disabled", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 115 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                                                                                                                              !enableButton

#line default
#line hidden
#nullable disable
                    ));
                    __builder3.AddAttribute(107, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder4) => {
                        __builder4.OpenComponent<Syncfusion.Blazor.SplitButtons.ProgressButtonEvents>(108);
                        __builder4.AddAttribute(109, "OnBegin", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<Syncfusion.Blazor.SplitButtons.ProgressEventArgs>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Syncfusion.Blazor.SplitButtons.ProgressEventArgs>(this, 
#nullable restore
#line 116 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                           Begin

#line default
#line hidden
#nullable disable
                        )));
                        __builder4.AddAttribute(110, "OnEnd", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Microsoft.AspNetCore.Components.EventCallback<Syncfusion.Blazor.SplitButtons.ProgressEventArgs>>(Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Syncfusion.Blazor.SplitButtons.ProgressEventArgs>(this, 
#nullable restore
#line 116 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
                                                                                         End

#line default
#line hidden
#nullable disable
                        )));
                        __builder4.CloseComponent();
                    }
                    ));
                    __builder3.CloseComponent();
                    __builder3.CloseElement();
                }
                ));
                __builder2.CloseComponent();
                __builder2.AddMarkupContent(111, "\r\n                              ");
                __builder2.OpenComponent<Syncfusion.Blazor.Popups.DialogPositionData>(112);
                __builder2.AddAttribute(113, "X", "center");
                __builder2.AddAttribute(114, "Y", "center");
                __builder2.CloseComponent();
            }
            ));
            __builder.CloseComponent();
            __builder.CloseElement();
            __builder.AddMarkupContent(115, "\r\n");
            __builder.AddMarkupContent(116, @"<style>
    .control-container {
        background-color: #adb5bd;
        height: 70vh;
        margin: 0 auto;
        width: 100%;
    }

    .e-carousel .slide-content {
        align-items: center;
        display: flex;
        font-size: 1.25rem;
        height: 100%;
        justify-content: center;
    }
    .floating-botton{
        position: absolute;
        bottom: 0;
        right: 0px;
        z-index: 3000;
    }
    .floating-container{
        position: absolute;
        width: 100%;
        bottom: 10%;
        left: 0px;
        z-index: 3000;
        background-color:rgba(135,206,235, 1);


    }
    .e-ddl.e-input-group.e-control-wrapper .e-input {
    font-size: 20px;
    font-family: emoji;
    color: #ab3243;
    background: #32a5ab;
}
.e-dropdownbase .e-list-item.e-item-focus, .e-dropdownbase .e-list-item.e-active, .e-dropdownbase .e-list-item.e-active.e-hover, .e-dropdownbase .e-list-item.e-hover {
    background-color: #1f9c99;
    color: #2319b8;
}
    .e-carousel .e-carousel-navigators .e-previous .e-btn:not(:disabled), .e-carousel .e-carousel-navigators .e-next .e-btn:not(:disabled), .e-carousel .e-carousel-navigators .e-play-pause .e-btn:not(:disabled) {
    background-color: #adaaaa !important;
}
   .e-dlg-center-center {
    position: fixed !important;
}
    .text-multiline textarea{ 
        height: 300px !important; 
    } 
</style>");
        }
        #pragma warning restore 1998
#nullable restore
#line 124 "C:\Users\Rebo\source\repos\DAaaS\BlazorDataAnalytics\Dialogs\PowerBITemplateDialog.razor"
       

    [CascadingParameter]
    private BlazoredModalInstance _modalInstance { get; set; }

    [CascadingParameter]
    public IModalService Modal { get; set; }

    [Parameter]
    public Guid _workspaceId { get; set; }
    [Parameter]
    public int? id { get; set; } = 0;
    [Parameter]
    public int _customerId { get; set; }
    [Parameter]
    public Reports _report { get; set; }
    [Parameter]
    public PowerBIClient _client{ get; set; }

    [Parameter]
    public bool refreshParent { get; set; } = false;

    [Parameter]
    public EventCallback<bool> RefreshPageEventCallBack { get; set; }

    public PowerBIEmbedConfig _result{ get; set; }
    private bool disableButton { get; set; } = false;
    private string Target { get; set; } = "body";
    MessageBoxDialog MessageDialog;
    public bool IsVisible { get; set; } = false;


    private bool showSpinner { get; set; }
    private ElementReference PowerBIElement;
    private IList<Group>? _group;
    private bool Visibility { get; set; } = false;
    private bool enableButton { get; set; } = true;
    private int _customerTenantId { get; set; }
    private UserVaultAppDetailModel UserVaultAppDetail = new UserVaultAppDetailModel();
    [Required]
    public string DropVal{ get; set; }
    [Required]
    public string selectedDataset{ get; set; }
    private Guid _reportId;   
    string buttonColor = string.Empty;
    string logo = string.Empty;
    string backgroundBody = string.Empty;
    private bool isRendered = false;
    private UserThemeSettingModel userTheme { get; set; } = new UserThemeSettingModel() ;
    public string CssClass { get; set; }
    public string Content = "Save....";
    public string reportName { get; set; }
    private IEnumerable<Claim> _claims = Enumerable.Empty<Claim>();
    private List<string> identifiersUI  = new List<string>();
    private Dictionary<string, ElementReference> carouselComponents = new Dictionary<string, ElementReference>();
    private List<ReportDetail> reportList = new List<ReportDetail>();
    public int SelectedIndex { get; set; }
    public EventCallback<int> SelectedIndexChanged { get; set; }
    public RenderFragment NextButtonTemplate { get; set; }
    private UserNameGroupRolesModel userNameGroupRolesModel = new UserNameGroupRolesModel();
    private string userNameIdentity { get; set; }
    private List<Dataset> datasetListCustomer = new List<Dataset>();
    private string _profileId = string.Empty;
    private bool IsRerender { get; set; } = false; 
    private bool IsEnableReportButton{ get; set; } = false; 

    public class ReportDetail 
    { 
        public string Id { get; set; } 
        public string Name{ get; set; } 
    }
    bool OnInputTriger = false;
    bool OnCreateReportTriger = false;


    protected override async Task OnInitializedAsync()
    {


    }
    public async Task OpenDialog(string workspaceId, int _id, int customerID, PowerBIClient client, Reports report,PowerBIEmbedConfig result)
    {
        this.IsVisible = true;
        this.refreshParent = false;
        this._report = report;
        this._client = client;
        this._workspaceId = new Guid(workspaceId);
        this.id = _id;
        this._customerId = customerID;
        this._result = result;

        foreach (var rep in _report.Value)
        {
            if(!identifiersUI.Contains(rep.Id.ToString()))
                identifiersUI.Add(rep.Id.ToString());
            if(!carouselComponents.ContainsKey(rep.Id.ToString()))
                carouselComponents.Add(rep.Id.ToString(), new ElementReference());
            ReportDetail repDet = new ReportDetail();
            repDet.Id = rep.Id.ToString();
            repDet.Name = rep.Name;
            if(reportList.Where(x=> x.Id== rep.Id.ToString()).FirstOrDefault()==null)
                reportList.Add(repDet);

        }
        //Retrieve workspace ID from customer
        var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
        var user = authState.User;
        userNameIdentity = user?.Identity?.Name;
        userNameGroupRolesModel = await _userSecurityService.GetUserNameGroupRoles(userNameIdentity);

        if (userNameGroupRolesModel.WorkspaceId == Guid.Empty)
        {
            showSpinner = false;
            return;
        }
        IsEnableReportButton = true;
        _customerTenantId = userNameGroupRolesModel.CustomerTenantId;
        var customerTenant = await _userSecurityService.GetCustomerTenants(_customerTenantId);
        if (customerTenant.ProfileId > 0)
        {
            var profile = _iAppOwnsDataMultiTenantDbService.GetProfileById((int)customerTenant.ProfileId);
            _profileId = profile != null ? profile.ProfileId : null;
        }
        this.StateHasChanged();
    }

    async Task OnChangeCarrosel(int x)
    {
        try
        {
            this.DropVal = this.reportList[x].Id;
        }
        catch (Exception ex) { }
    }

    private void OnBtnClick()
    {
        if (_report.Value.Count() > 0)
        {
            this.Target = "#dialog.e-dialog";
            this.OnCreateReportTriger = true;
            this.Visibility = !this.Visibility;
            IsRerender = true;
        }
    }
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (OnCreateReportTriger)
        {
            OnCreateReportTriger = false;
            return;
        }
        showSpinner = true;
        if (!IsRerender)
        {
           await RenderReport(firstRender);
        }
        if (firstRender)
        {
            var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
            var user = authState.User;
            var   claims = user.Claims;
            var   userEmail = claims?.FirstOrDefault(x => x.Type.Equals("preferred_username", StringComparison.OrdinalIgnoreCase))?.Value;              
            this.DropVal = this.reportList.Count > 0 ? this.reportList[0].Id: null;
            if (id > 0)
            {
                UserVaultAppDetail = await _userVaultService.GetUserVaultAppDetails(id);

            }
        }


        showSpinner = false;

    }
    public void Begin(Syncfusion.Blazor.SplitButtons.ProgressEventArgs args)
    {
        Content = "Saving...";
        CssClass = "e-hide-spinner e-info border-radius";
    }

    public async Task End(Syncfusion.Blazor.SplitButtons.ProgressEventArgs args)
    {
        await   GenerateReport();
        Content = "Saved....";
        CssClass = "e-hide-spinner e-success border-radius";
        await Task.Delay(1000);
        Content = "Save....";
        CssClass = "e-hide-spinner border-radius";

    }
    private void ValueChangeHandler(ChangeEventArgs<string, Dataset> args)
    {
        // Here, you can customize your code.
        IsRerender = true;
    }
    private async void ValueChangeHandler(ChangeEventArgs<string, ReportDetail> args)
    {
        disableButton = args.Value != string.Empty;
        selectedDataset = null;
        if (args.Value != null)
        {
            AuthenticationResult authenticationResult = null;
            authenticationResult = await DoAuthentication();
            DatasetManager dsmanager ;
            dsmanager = new DatasetManager(true, userNameGroupRolesModel.WorkspaceUrl,authenticationResult);
            string reportData = reportList.Where(x => x.Id == DropVal).FirstOrDefault().Id;
            var datasetfromTemplate = _client.Reports.GetReport(new Guid(_configuration.GetSection("PowerBiTemplate:WorkspaceId").Value),new Guid(reportData));
            var datasetTemplate = _client.Datasets.GetDataset(new Guid(_configuration.GetSection("PowerBiTemplate:WorkspaceId").Value),datasetfromTemplate.DatasetId);
            var dataSetList = _client.Datasets.GetDatasets(_workspaceId);

            var templateTables = dsmanager.GetAllTablesFromTemplateWorkspace(datasetTemplate.Name);

            int counter = templateTables.Tables.Where(x=> !x.Name.ToLower().Contains("datetabletemplate") && !x.Name.ToLower().Contains("localdatetable")) != null ? templateTables.Tables.Where(x=> !x.Name.ToLower().Contains("datetabletemplate") && !x.Name.ToLower().Contains("localdatetable")) .Count() : 0;
            foreach (var item in dataSetList.Value)
            {
                var tablesFromCustomer = dsmanager.GetAllTablesFromCustomerWorkspace(item.Name);
                if(tablesFromCustomer!=null)
                    foreach (var ds in templateTables.Tables.Where(x=> !x.Name.ToLower().Contains("datetabletemplate") && !x.Name.ToLower().Contains("localdatetable")))
                    {
                        if(tablesFromCustomer.Tables.Where(x=> x.Name.ToLower().Trim() == ds.Name.Trim() &&
                                                   (!x.Name.ToLower().Contains("datetabletemplate") && !x.Name.ToLower().Contains("localdatetable"))) !=null 
                                                   && tablesFromCustomer.Tables.Where(x=> x.Name.Trim() == ds.Name.Trim() 
                                                   && (!x.Name.ToLower().Contains("datetabletemplate") 
                                                   && !x.Name.ToLower().Contains("localdatetable"))).Count() > 0 )
                        {
                            counter--;
                            if (counter == 0)
                            {
                                var dsCustomer = _client.Datasets.GetDataset( _workspaceId, tablesFromCustomer.Database.ID); 
                                datasetListCustomer.Add(dsCustomer);
                            }
                        }

                    }



            } 

        }
    }

    private const string AuthorityFormat = "https://login.microsoftonline.com/94e6b5f2-d1da-4de9-a4ca-88cfdb6c3de0/v2.0";
    private const string MSGraphScope = "https://analysis.windows.net/powerbi/api/.default";
    private async Task<Microsoft.Identity.Client.AuthenticationResult> DoAuthentication()
    {
        IConfidentialClientApplication daemonClient;
        daemonClient = ConfidentialClientApplicationBuilder.Create(_configuration.GetSection("AzureAd:ClientId").Value)
            .WithAuthority(string.Format(AuthorityFormat, _configuration.GetSection("AzureAd:TenantId").Value))
            .WithClientSecret(_configuration.GetSection("AzureAd:ClientSecret").Value)
            .Build();

        AuthenticationResult authResult = await daemonClient.AcquireTokenForClient(new[] { MSGraphScope }).ExecuteAsync();
        return authResult;
    }

    private async Task RenderReport(bool firstRender)
    {
        if(_report !=null && _report.Value !=null)
        foreach (var report in _report.Value)
        {
            //  var clientReport = _client.Reports.GetReport(_workspaceId, Guid.Parse(_report.Value.First().Id.ToString()));
            var generateTokenRequestParameters = new GenerateTokenRequest(accessLevel: "View");
            var tokenResponse = _client.Reports.GenerateTokenAsync(new Guid( _configuration.GetSection("PowerBiTemplate:WorkspaceId").Value), new Guid(report.Id.ToString()), generateTokenRequestParameters).Result;

            _result.EmbedToken = tokenResponse;
            _result.EmbedUrl = report.EmbedUrl;
            _result.Id = report.Id.ToString();
            JSRuntime.InvokeAsync<object>(
                    "ShowMyPowerBI.showReport",
                    carouselComponents[report.Id.ToString()],
                    tokenResponse.Token,
                    report.EmbedUrl,
                     report.Id.ToString(),
                    "true",
                    "false"
                    );
        }
        if (firstRender) { InvokeAsync(() => StateHasChanged()); };
    }
    private void Cancel()
    {
        _modalInstance.CancelAsync();
    }

    private async Task Close()
    {
        await _modalInstance.CloseAsync();
    }

    public async Task GenerateReport()
    {
        if (string.IsNullOrEmpty(DropVal)) return;
        try
        {
            var reportItem = _report.Value.Where(x => x.Id == new Guid(DropVal)).FirstOrDefault();

            CloneReportRequest cloneReportRequest = new CloneReportRequest();
            cloneReportRequest.Name = reportName;
            cloneReportRequest.TargetWorkspaceId = _workspaceId;

            var cloned = _client.Reports.CloneReportInGroup(new Guid(_configuration.GetSection("PowerBiTemplate:WorkspaceId").Value), reportItem.Id, cloneReportRequest);
            var datasets = _client.Datasets.GetDataset(new Guid(_configuration.GetSection("PowerBiTemplate:WorkspaceId").Value), reportItem.DatasetId);
            AuthenticationResult authenticationResult = null;
            authenticationResult = await DoAuthentication();
            DatasetManager manager = new DatasetManager(true, userNameGroupRolesModel.WorkspaceUrl, authenticationResult);
            var newDataset = new Microsoft.AnalysisServices.Tabular.Database();
            if (selectedDataset == null)
            {
                newDataset = await DatasetManager.CopyDatabaseToOtherWorkspace(datasets.Name, reportName);
                //  _client.Datasets.TakeOver(_workspaceId, newDataset.ID.ToString());
                SqlConnectionStringBuilder connectionStringBuilder =new SqlConnectionStringBuilder(_configuration.GetConnectionString("XeroConnection"));
                if(id > 0 && !string.IsNullOrEmpty(UserVaultAppDetail.DatabaseName) && !string.IsNullOrEmpty(UserVaultAppDetail.ServerName) && !string.IsNullOrEmpty(UserVaultAppDetail.UserPassword) && !string.IsNullOrEmpty(UserVaultAppDetail.UserName))
                    manager.PatchSqlDatasourceCredentials(_workspaceId, newDataset.ID,UserVaultAppDetail.ServerName,UserVaultAppDetail.DatabaseName, UserVaultAppDetail.UserName,UserVaultAppDetail.UserPassword,_profileId);
                else
                    manager.PatchSqlDatasourceCredentials(_workspaceId, newDataset.ID, AppSettings.sqlUserName, AppSettings.sqlUserPassword,_profileId, connectionStringBuilder.DataSource.ToString());
            }
            else
            {
                newDataset.ID = selectedDataset;

            }

            RebindReportRequest rebindReq = new RebindReportRequest();
            rebindReq.DatasetId = newDataset.ID;
            _client.Datasets.RefreshDataset(_workspaceId, newDataset.ID);
            _client.Reports.RebindReport(_workspaceId, cloned.Id, rebindReq);
            _client.Datasets.TakeOver(_workspaceId, newDataset.ID);

            var customerUserRole = new CustomerUserRole
            {
                CustomerTernantId = _customerTenantId,
                Description = $"View {reportName} Report",
                UserRoleName =reportName,
                IsActive = true,
            };

            string reportRoleCode = await _userSecurityService.InsertCustomerUserRoleByName(customerUserRole);

            string newTitle = await _reportDashboardService.UpsertReportInDashboard(reportName,cloned.Id, reportRoleCode);


            this.Visibility= !this.Visibility;
            reportName = null;
            selectedDataset = null;


            MessageDialog.OpenDialog(AlertStatus.Success,string.Format("Report for '{0}' successfully created.", cloned.Name));

        } catch (Exception ex) {

            MessageDialog.OpenDialog(AlertStatus.Danger, ex.Message);
        }
        //}
        //catch (Exception ex) { }

    }
    private void showAlertMessage(string alertType, string message, string title)
    {

         MessageDialog.OpenDialog(alertType, message);

    }
    public void CloseDialog()
    {
        this.IsVisible = false;
        this.StateHasChanged();
    }


#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IAppOwnsDataMultiTenantDbService _iAppOwnsDataMultiTenantDbService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private AuthenticationStateProvider AuthenticationStateProvider { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IReportDashboardService _reportDashboardService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IKeyVaultManager _keyVaultManager { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IUserVaultService _userVaultService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IUserSecurityService _userSecurityService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IConfiguration _configuration { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IJSRuntime JSRuntime { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private BlazoradeMsalService msalService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private NavigationManager UriHelper { get; set; }
    }
}
#pragma warning restore 1591
